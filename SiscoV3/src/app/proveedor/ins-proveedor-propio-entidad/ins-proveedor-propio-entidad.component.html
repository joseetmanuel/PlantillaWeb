<div [ngClass]="{'desactivaPantalla': loading }">
    <mat-spinner *ngIf='loading' class="spinner"></mat-spinner>

    <app-breadcrumbs *ngIf="breadcrumb" [ruta]="breadcrumb" urlImagen="./assets/images/iconos-sisco/talleres.png">
    </app-breadcrumbs>

    <div [formGroup]="datosProveedorForm" style="margin-bottom: 10px;">
        <mat-card>
            <div class="row">
                <div class="col-sm-12 col-md-12 col-xl-12">
                    <div class="col-sm-12 col-md-12 col-xl-12">
                        <div *ngFor="let objeto of modulo.camposClase" style="display: inline;">
                            <img *ngIf="objeto.nombre=='LogoCardProveedor'" class='imagenIconoGris' [src]="objeto.path">
                            <span *ngIf="objeto.nombre=='LogoCardProveedor'">&nbsp;&nbsp;&nbsp;</span>
                        </div>
                        <div *ngFor="let objeto of modulo.camposClase" style="display: inline;">
                            <span *ngIf="objeto.nombre=='TituloCardProveedor'">{{objeto.label}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class='col-sm-12 col-md-6 col-xl-6 text-center'>
                    <mat-form-field class="inputFullWide">
                        <input matInput formControlName="nombreComercial" [value]="datosProveedor?.razonSocial"
                            placeholder="Razon social">
                    </mat-form-field>
                </div>
                <div class="col-sm-12 col-md-6 col-xl-6">
                    <mat-form-field class="inputFullWide">
                        <input matInput formControlName="razonSocial" [value]="datosProveedor?.nombreComercial"
                            placeholder="Nombre comercial">
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class='col-sm-12 col-md-6 col-xl-6 text-center'>
                    <mat-form-field class="inputFullWide">
                        <input matInput formControlName="rfcProveedor" [value]="datosProveedor?.rfcProveedor"
                            placeholder="RFC">
                    </mat-form-field>
                </div>
                <div class="col-sm-12 col-md-6 col-xl-6">
                    <mat-form-field class="inputFullWide">
                        <input matInput formControlName="personaContacto" [value]="datosProveedor?.personaContacto"
                            placeholder="Contacto">
                    </mat-form-field>
                </div>
            </div>
        </mat-card>
    </div>
    <div style="margin-bottom: 10px;">
        <app-form-proveedor-propio [modulo]="modulo" [formValid]="true" class="col-sm-12 col-md-12 col-xl-12"
            [proveedorEntidad]="true" [rfcProveedor]="rfcProveedor" [tituloForm]="tituloForm" [showMaps]="true"
            [datosProveedor]="datosProveedor" [tituloDireccion]="tituloDireccion" [newProveedor]="true"
            (formProveedorEvent)="AgregarProveedorEntidad($event)">
            <div class="row">
                <mat-divider></mat-divider>
                <div class="col-sm-12 col-md-12 col-xl-12" style="margin-top:10px">Datos generales</div>
                <div class="col-sm-12 col-md-6 col-lg-6"
                    *ngFor="let tipoObjeto of tipoObjetoPropiedades, let index = index">
                    <div *ngIf="tipoObjeto.idTipoValor != 'Unico'">
                        <div class="inputFullWide">
                            <small class="titulo-input-dinamico"
                                *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                            <small class="titulo-input-dinamico" *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                *</small>
                            <dx-drop-down-box #dropBox [dataSource]="tipoObjeto.arreglo"
                                placeholder="Selecciona {{tipoObjeto.valor}}" displayExpr="valor" valueExpr="id"
                                [showClearButton]="true" [(value)]="tipoObjeto.label"
                                (onValueChanged)="closeWindow(dropBox, tipoObjeto.idTipoValor == 'Etiqueta')">
                                <div *dxTemplate="let data of 'content'">
                                    <div
                                        *ngIf="tipoObjeto.idTipoValor == 'Agrupador' || tipoObjeto.idTipoValor == 'Catalogo'">
                                        <dx-tree-view [dataSource]="tipoObjeto.arreglo" dataStructure="plain"
                                            keyExpr="id" parentIdExpr="idPadre" displayExpr="valor"
                                            [selectByClick]="true" selectionMode="single" noDataText="No contiene datos"
                                            (onItemSelectionChanged)="TreeView_itemSelectionChanged($event, tipoObjeto)">
                                        </dx-tree-view>
                                    </div>
                                    <div *ngIf="tipoObjeto.idTipoValor == 'Etiqueta'">
                                        <dx-tree-view [dataSource]="tipoObjeto.arreglo" dataStructure="plain"
                                            keyExpr="id" parentIdExpr="idPadre" displayExpr="valor"
                                            [selectByClick]="true" selectionMode="multiple"
                                            noDataText="No contiene datos" showCheckBoxesMode="normal"
                                            [selectNodesRecursive]="true"
                                            (onItemSelectionChanged)="TreeView_itemSelectionChanged($event, tipoObjeto)">
                                        </dx-tree-view>
                                    </div>
                                </div>
                            </dx-drop-down-box>
                        </div>
                    </div>
                    <div *ngIf="tipoObjeto.idTipoValor == 'Unico'" class="col-md-12 col-lg-12" style="margin: auto;">
                        <mat-form-field *ngIf="tipoObjeto.idTipoDato == 'String'" class="inputFullWide"
                            style="width: 100%; padding-top: 10px;">
                            <input matInput [placeholder]="tipoObjeto.valor" (keyup)="ChangePropiedad($event,index)"
                                (blur)="ChangePropiedad($event,index)" ([value])="tipoObjeto.valorSelected"
                                (change)="ChangeInput($event, index)" [required]="tipoObjeto.obligatorio">
                        </mat-form-field>
                        <small class="text-error" *ngIf="!tipoObjeto.valid">Campo obligatorio</small>

                        <div *ngIf="tipoObjeto.idTipoDato == 'Date'" class="col-md-12 col-lg-12" style="margin: auto;">
                            <mat-form-field>
                                <div class="inputFullWide">
                                    <small class="titulo-input-dinamico">{{tipoObjeto.valor}}</small>
                                    <dx-date-box placeholder="Indica {{tipoObjeto.valor}}"
                                        (change)="ChangePropiedad($event,index)" [displayFormat]="'dd/MM/yyyy'"
                                        [(value)]="tipoObjeto.valorSelected" type="date" [showClearButton]="true">
                                    </dx-date-box>
                                    <small class="titulo-input-dinamico"
                                        *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                                    <small class="titulo-input-dinamico"
                                        *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                        *</small>
                                </div>
                            </mat-form-field>
                        </div>

                        <div *ngIf="tipoObjeto.idTipoDato == 'Decimal' || tipoObjeto.idTipoDato == 'Numeric'"
                            class="col-md-12 col-lg-12" style="margin: auto;">
                            <div class="inputFullWide">
                                <small class="titulo-input-dinamico"
                                    *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                                <small class="titulo-input-dinamico" *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                    *</small>
                                <dx-number-box [(value)]="tipoObjeto.valorSelected"
                                    placeholder="Indica {{tipoObjeto.valor}}" [showSpinButtons]="true"
                                    (onValueChanged)="ChangePropiedad($event,index)"
                                    (change)="ChangePropiedad($event,index)" [showClearButton]="true">
                                </dx-number-box>
                                <small class="titulo-input-dinamico"
                                    *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                                <small class="titulo-input-dinamico" *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                    *</small>
                            </div>
                        </div>
                        <div *ngIf="tipoObjeto.idTipoDato == 'File' || tipoObjeto.idTipoDato == 'Image'"
                            class="col-md-12 col-lg-12" style="margin: auto;">
                            <small class="titulo-input-dinamico"
                                *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                            <small class="titulo-input-dinamico" *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                *</small>
                            <app-file-upload-component [IUploadFile]="IUploadFile"
                                (messageEvent)="ResultUploadFile($event, index)">
                            </app-file-upload-component>
                        </div>
                        <div *ngIf="tipoObjeto.idTipoDato == 'DateTime'">
                            <div class="inputFullWide">
                                <small class="titulo-input-dinamico"
                                    *ngIf="!tipoObjeto.obligatorio">{{tipoObjeto.valor}}</small>
                                <small class="titulo-input-dinamico" *ngIf="tipoObjeto.obligatorio">{{tipoObjeto.valor}}
                                    *</small>
                                <dx-date-box [(value)]="tipoObjeto.valorSelected" type="datetime"
                                    [showClearButton]="true" placeholder="Indica {{tipoObjeto.valor}}"
                                    [showClearButton]="true" applyButtonText="Aceptar" cancelButtonText="Cancelar">
                                </dx-date-box>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </app-form-proveedor-propio>
    </div>
</div>